@echo off
setlocal enabledelayedexpansion

:: Step 1: Collect system info
systeminfo > "%TEMP%\sysinfo.txt"

:: Step 2: Setup variables
set "COMPUTER=%COMPUTERNAME%"

echo.
echo Sending system info to server...
echo.

:: Step 3: Start PowerShell upload silently
start /b "" powershell -NoProfile -Command "$body=@{computer='%COMPUTER%';info=(Get-Content '%TEMP%\sysinfo.txt' -Raw)}; try {Invoke-WebRequest -Uri '%URL%' -Method POST -Body $body -ErrorAction Stop} catch {Write-Host ('Upload failed: ' + $_.Exception.Message)}" >nul 2>&1

:: Step 4: Simulated loading bar
set /a progress=0
set "bar="

:loading
set /a progress+=5
set "bar=!bar!#"
cls
echo Sending system info to server...
echo.
echo [!bar! ] !progress!%%

if !progress! lss 100 (
    timeout /nobreak /t 1 >nul
    goto loading
)

echo.
echo Upload complete
echo.
pause
endlocal
